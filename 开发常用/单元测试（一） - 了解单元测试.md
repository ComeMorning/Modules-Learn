## 单元测试是什么

单元测试（又称为模块测试, Unit Testing）是针对程序模块（软件设计的最小单位）来进行正确性检验的测试工作。程序单元是应用的最小可测试部件。在过程化编程中，一个单元就是单个程序、函数、过程等；对于面向对象编程，最小单元就是方法，包括基类（超类）、抽象类、或者派生类（子类）中的方法。

编写单元测试的难易程度能够直接反应出代码的设计水平，能写出单元测试和写不出单元测试之间体现了编程能力上的巨大的鸿沟。无论是什么样的程序员，坚持编写一段时间的单元测试之后，都会明显感受到代码设计能力的巨大提升。

单元测试有以下好处：

- 确保代码质量
- 改善代码设计，难以测试的代码一般是设计不够简洁的代码。
- 保证后续开发不会对之前的代码造成影响。不管是在前期开发阶段，还是对项目进行优化、重构，关键的测试用例能保障项目的交付时不会重复出现以前出现过的bug。

最后一点是在复杂项目中最能体现出来的，当你的核心代码已经实现了一部分，并且临时可用了，但是需要继续完善细节功能，这个后续完善的过程可能会使得之前的核心代码部分有所改动，比如增加了一些变量和方法，继承、派生了新的类，这些新增的代码是否对之前的核心代码产生影响？如果我们每写完一个函数、方法都编写了对应的测试用例，后续代码只要通过了所有的测试用例，就可粗略的认为在代码**逻辑正确性**上是没有问题了，至于性能问题是另一回事，在此先不展开讨论。

## 测试如何影响代码设计

<img src="https://md-picture-1254350681.cos.ap-beijing.myqcloud.com/v2-719f3f46c01bfdc85ba1be7cb6bdd40a_r.jpg" alt="img" style="zoom:80%;" />

<img src="https://md-picture-1254350681.cos.ap-beijing.myqcloud.com/v2-a9358cb2cd749eedf42e427cf4ce45b2_r.jpg" alt="img" style="zoom:80%;" />

<img src="https://md-picture-1254350681.cos.ap-beijing.myqcloud.com/v2-59283302baf59bc1c84cbfcc442be633_r.jpg" alt="img" style="zoom:80%;" />

以上来自《编写可读代码的艺术》，需要自己实践才有体会。

## python测试相关库

- unittest，内置库，模仿PyUnit写的，简洁易用，缺点是比较繁琐。
- nose，测试发现，发现并运行测试。
- pytest，笔者目前喜欢用这个，写起来很方便，并且很多知名开源项目在用，推荐。
- mock, 替换掉网络调用或者 rpc 请求等



参考：

https://zhuanlan.zhihu.com/p/29968920